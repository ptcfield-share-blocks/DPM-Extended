<?xml version="1.0" encoding="UTF-8" standalone="no"?><Entities build="b141" majorVersion="9" minorVersion="5" modelPersistenceProviderPackage="MssqlPersistenceProviderPackage" revision="0" schemaVersion="1150" universal=""><StyleDefinitions/><Networks/><PersistenceProviderPackages/><Mashups/><ScriptFunctionLibraries/><Projects><Project artifactId="" aspect.isEditableExtensionObject="true" aspect.isExtension="true" aspect.projectType="Component" dependsOn="{&quot;extensions&quot;:&quot;&quot;,&quot;projects&quot;:&quot;PTC.Base:0.0.0&quot;}" description="" documentationContent="" groupId="" homeMashup="" lastModifiedDate="2024-01-23T19:48:38.389Z" minPlatformVersion="" name="PTCDTS.SMAXIntegration" packageVersion="1.0.0" projectName="PTCDTS.SMAXIntegration" publishResult="" state="DRAFT" tags=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.669Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.386Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.389Z" user="Administrator"/></ConfigurationChanges></Project></Projects><Users/><DirectoryServices/><Widgets/><MediaEntities/><Groups><Group aspect.isEditableExtensionObject="true" aspect.isExtension="true" description="" documentationContent="" homeMashup="" lastModifiedDate="2024-01-23T19:48:38.414Z" name="PTCDTS.SMAXIntegration.Default_UG" projectName="PTCDTS.SMAXIntegration" scimDisplayName="" scimExternalId="" scimId="" tags=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><Members><Members><Member name="PTCDTS.Base.Permissions.Default_UG" type="Group"/></Members></Members><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.655Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.411Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.414Z" user="Administrator"/></ConfigurationChanges></Group><Group aspect.isEditableExtensionObject="true" aspect.isExtension="true" description="" documentationContent="" homeMashup="" lastModifiedDate="2024-01-23T19:48:38.395Z" name="PTCDTS.SMAXIntegration.Admin_UG" projectName="PTCDTS.SMAXIntegration" scimDisplayName="" scimExternalId="" scimId="" tags=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><Members><Members><Member name="PTCDTS.Base.Permissions.ApplicationAdmin_UG" type="Group"/></Members></Members><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.657Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.392Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.396Z" user="Administrator"/></ConfigurationChanges></Group></Groups><PersistenceProviders/><ModelTags/><LocalizationTables/><Dashboards/><StyleThemes/><DataShapes><DataShape aspect.isEditableExtensionObject="true" aspect.isExtension="true" baseDataShape="" description="A data table to define fields in a configuration table containing information needed to authenticate to and use ServiceMax REST API services." documentationContent="" homeMashup="" lastModifiedDate="2024-01-23T19:48:38.401Z" name="PTCDTS.SMAXIntegration.AuthenticationConfiguration" projectName="PTCDTS.SMAXIntegration" tags=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="ServiceMax/Salesforce client ID. See SFDC.SMAX docs for more information." name="client_id" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="A secret API key generated within Salesforce/ServiceMax. See ServiceMax docs on how to generate this value." name="client_secret" ordinal="2"/><FieldDefinition aspect.defaultValue="password" aspect.isPrimaryKey="false" baseType="STRING" description="Used by Salesforce/ServiceMax to determine authentication attempt type." name="grant_type" ordinal="4"/><FieldDefinition aspect.defaultValue="https://login.salesforce.com/services/oauth2/token" aspect.isPrimaryKey="false" baseType="STRING" description="The URL provided by Salesforce/ServiceMax" name="login_url" ordinal="6"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="Salesforce/ServiceMax password for user defined by username." name="password" ordinal="3"/><FieldDefinition aspect.defaultValue="https://svmx-validation.lightning.force.com" aspect.isPrimaryKey="false" baseType="STRING" description="" name="servicemax_domain" ordinal="7"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="ServiceMax/Salesforce user ID" name="username" ordinal="1"/></FieldDefinitions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.659Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.399Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.402Z" user="Administrator"/></ConfigurationChanges></DataShape></DataShapes><Things><Thing aspect.isEditableExtensionObject="true" aspect.isExtension="true" aspect.isSystemObject="false" description="ServiceMax Integrator" documentationContent="" effectiveThingPackage="ConfiguredThing" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2024-01-23T19:48:38.671Z" name="PTCDTS.SMAXIntegration.Manager" projectName="PTCDTS.SMAXIntegration" published="false" tags="" thingTemplate="PTCDTS.SMAXIntegration.Manager_TT" valueStream=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table used to identify managers that the building block should use" isMultiRow="true" name="ManagerConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="" isMultiRow="true" name="MashupConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="MASHUPNAME" description="name of the mashup to configure" name="mashupName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for dynamic menus. Menu Items can be specified here and they will show up for the given menu name. " isMultiRow="true" name="MenuConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="menuItemMashupName" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="" name="menuName" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="An optional field to indicate the ordering of the menu items" name="menuOrderPreference" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the optional section that groups like menus together" name="menuSectionKey" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the menu label" name="menuTitleKey" ordinal="1"/><FieldDefinition aspect.dataShape="PTC.Base.ComponentMenuConfiguration" aspect.isPrimaryKey="false" baseType="INFOTABLE" description="" name="submenu" ordinal="6"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="ServiceMaxConfigTable" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="ServiceMax/Salesforce client ID. See SFDC.SMAX docs for more information." name="client_id" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="A secret API key generated within Salesforce/ServiceMax. See ServiceMax docs on how to generate this value." name="client_secret" ordinal="2"/><FieldDefinition aspect.defaultValue="password" aspect.isPrimaryKey="false" baseType="STRING" description="Used by Salesforce/ServiceMax to determine authentication attempt type." name="grant_type" ordinal="4"/><FieldDefinition aspect.defaultValue="https://login.salesforce.com/services/oauth2/token" aspect.isPrimaryKey="false" baseType="STRING" description="The URL provided by Salesforce/ServiceMax" name="login_url" ordinal="6"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="Salesforce/ServiceMax password for user defined by username." name="password" ordinal="3"/><FieldDefinition aspect.defaultValue="https://svmx-validation.lightning.force.com" aspect.isPrimaryKey="false" baseType="STRING" description="" name="servicemax_domain" ordinal="7"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="ServiceMax/Salesforce user ID" name="username" ordinal="1"/></FieldDefinitions></DataShape><Rows><Row><client_id/><client_secret/><grant_type><![CDATA[password]]></grant_type><login_url><![CDATA[https://login.salesforce.com/services/oauth2/token]]></login_url><password/><servicemax_domain><![CDATA[https://svmx-validation.lightning.force.com]]></servicemax_domain><username/></Row></Rows></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for any Things that need to be configured. This allows for OOTB things to be customized, and the new version that should be used can be configured here" isMultiRow="true" name="ThingConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="THINGNAME" description="Name of the Thing entity or Mashup entity that is to be configured" name="thingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ImplementedShapes/><ThingProperties><access_token><Value/><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></access_token><access_token_issued_time><Value>0</Value><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></access_token_issued_time><instance_url><Value/><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></instance_url><token_type><Value><![CDATA[Bearer]]></Value><Timestamp>1970-01-01T00:00:00.000Z</Timestamp><Quality>UNKNOWN</Quality></token_type></ThingProperties><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.673Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.436Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.439Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.650Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.653Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.655Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.657Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.660Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.662Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.664Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.667Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.669Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.671Z" user="Administrator"/></ConfigurationChanges></Thing><Thing aspect.isEditableExtensionObject="true" aspect.isExtension="true" aspect.isSystemObject="false" description="ServiceMax Integrator" documentationContent="" effectiveThingPackage="ConfiguredThing" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2024-01-23T19:48:38.472Z" name="PTCDTS.SMAXIntegration.EntryPoint" projectName="PTCDTS.SMAXIntegration" published="false" tags="" thingTemplate="PTCDTS.SMAXIntegration.EntryPoint_TT" valueStream=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table to store the components core manager" isMultiRow="true" name="ComponentManager" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows><Row><id><![CDATA[ComponentManager]]></id><managerThingName><![CDATA[PTCDTS.SMAXIntegration.Manager]]></managerThingName></Row></Rows></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ImplementedShapes/><ThingProperties><componentDefaultOrg><Value><![CDATA[PTCDTS.SMAXIntegration.Default_OR]]></Value><Timestamp>2023-09-28T13:16:59.062Z</Timestamp><Quality>GOOD</Quality></componentDefaultOrg><componentDefaultUserGroup><Value><![CDATA[PTCDTS.SMAXIntegration.Default_UG]]></Value><Timestamp>2023-09-28T13:16:59.062Z</Timestamp><Quality>GOOD</Quality></componentDefaultUserGroup><componentDeploymentState><Value><![CDATA[Configured]]></Value><Timestamp>2024-01-23T19:43:04.714Z</Timestamp><Quality>GOOD</Quality></componentDeploymentState><componentDescription><Value><![CDATA[ServiceMax Integrator]]></Value><Timestamp>2023-09-28T13:16:59.062Z</Timestamp><Quality>GOOD</Quality></componentDescription><componentMainMashup><Value/><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></componentMainMashup><componentName><Value><![CDATA[PTCDTS.SMAXIntegration]]></Value><Timestamp>2023-09-28T13:16:59.062Z</Timestamp><Quality>GOOD</Quality></componentName><componentThumbnail><Value/><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></componentThumbnail><componentType><Value><![CDATA[Standard]]></Value><Timestamp>2023-09-28T13:16:59.062Z</Timestamp><Quality>GOOD</Quality></componentType><componentVersion><Value><![CDATA[9.5.0]]></Value><Timestamp>2023-09-28T13:16:59.110Z</Timestamp><Quality>GOOD</Quality></componentVersion><dependentComponents><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Common name of the component" name="ComponentName" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Component's project name" name="ComponentProjectName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></dependentComponents><deployComponentStatus><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="{}" aspect.isPrimaryKey="false" baseType="JSON" description="Information about the internal status." name="additionalInfo" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Name of the Component" name="name" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="config status of the component" name="status" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Type of action." name="type" ordinal="2"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></deployComponentStatus><migrateComponentStatus><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="{}" aspect.isPrimaryKey="false" baseType="JSON" description="Information about the internal status." name="additionalInfo" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Name of the Component" name="name" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="config status of the component" name="status" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Type of action." name="type" ordinal="2"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></migrateComponentStatus><upgradeComponentStatus><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="{}" aspect.isPrimaryKey="false" baseType="JSON" description="Information about the internal status." name="additionalInfo" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Name of the Component" name="name" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="config status of the component" name="status" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Type of action." name="type" ordinal="2"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2024-01-23T19:43:00.695Z</Timestamp><Quality>GOOD</Quality></upgradeComponentStatus></ThingProperties><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.671Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.417Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.421Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.451Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.454Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.456Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.459Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.461Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.463Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.466Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.468Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.470Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteRunTimePermissions" timestamp="2024-01-23T19:48:38.472Z" user="Administrator"/></ConfigurationChanges></Thing></Things><Logs/><Authenticators/><ThingPackages/><NotificationDefinitions/><ApplicationKeys/><StateDefinitions/><ThingTemplates><ThingTemplate aspect.isEditableExtensionObject="true" aspect.isExtension="true" aspect.isSystemObject="false" baseThingTemplate="PTC.Base.ComponentEntryPoint_TT" description="ServiceMax Integrator" documentationContent="" effectiveThingPackage="ConfiguredThing" homeMashup="" inheritedValueStream="" lastModifiedDate="2024-01-23T19:48:38.426Z" name="PTCDTS.SMAXIntegration.EntryPoint_TT" projectName="PTCDTS.SMAXIntegration" tags="" thingPackage="" valueStream=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table to store the components core manager" isMultiRow="true" name="ComponentManager" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable></ConfigurationTables><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ThingShape><PropertyDefinitions/><ServiceDefinitions><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="true" isLocalOnly="false" isOpen="false" isPrivate="false" name="RegisterManager"><ResultType baseType="NOTHING" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition></ServiceDefinitions><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="Script" name="DeployComponent"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// Return true as a default
var result = true;

me.RegisterManager();]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="RegisterManager"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: THINGNAME
let managerName = me.GetConfiguredComponentManager();

Things["PTC.Base.Manager"].AddGlobalManagerConfigurationEntry({
	managerName: managerName /* THINGNAME */,
	key: "PTC.SMAXIntegration.Manager" /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions/></ThingShape><ImplementedShapes/><SharedConfigurationTables/><InstanceDesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></InstanceDesignTimePermissions><InstanceRunTimePermissions/><InstanceVisibilityPermissions><Visibility/></InstanceVisibilityPermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.667Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.424Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.427Z" user="Administrator"/></ConfigurationChanges></ThingTemplate><ThingTemplate aspect.isEditableExtensionObject="true" aspect.isExtension="true" aspect.isSystemObject="false" baseThingTemplate="PTC.Base.CommonManager_TT" description="ServiceMax Integrator" documentationContent="" effectiveThingPackage="ConfiguredThing" homeMashup="" inheritedValueStream="" lastModifiedDate="2024-01-23T19:48:38.445Z" name="PTCDTS.SMAXIntegration.Manager_TT" projectName="PTCDTS.SMAXIntegration" tags="" thingPackage="" valueStream=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table used to identify managers that the building block should use" isMultiRow="true" name="ManagerConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="" isMultiRow="true" name="MashupConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="MASHUPNAME" description="name of the mashup to configure" name="mashupName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for dynamic menus. Menu Items can be specified here and they will show up for the given menu name. " isMultiRow="true" name="MenuConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="menuItemMashupName" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="" name="menuName" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="An optional field to indicate the ordering of the menu items" name="menuOrderPreference" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the optional section that groups like menus together" name="menuSectionKey" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the menu label" name="menuTitleKey" ordinal="1"/><FieldDefinition aspect.dataShape="PTC.Base.ComponentMenuConfiguration" aspect.isPrimaryKey="false" baseType="INFOTABLE" description="" name="submenu" ordinal="6"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="ServiceMaxConfigTable" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="ServiceMax/Salesforce client ID. See SFDC.SMAX docs for more information." name="client_id" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="A secret API key generated within Salesforce/ServiceMax. See ServiceMax docs on how to generate this value." name="client_secret" ordinal="2"/><FieldDefinition aspect.defaultValue="password" aspect.isPrimaryKey="false" baseType="STRING" description="Used by Salesforce/ServiceMax to determine authentication attempt type." name="grant_type" ordinal="4"/><FieldDefinition aspect.defaultValue="https://login.salesforce.com/services/oauth2/token" aspect.isPrimaryKey="false" baseType="STRING" description="The URL provided by Salesforce/ServiceMax" name="login_url" ordinal="6"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="Salesforce/ServiceMax password for user defined by username." name="password" ordinal="3"/><FieldDefinition aspect.defaultValue="https://svmx-validation.lightning.force.com" aspect.isPrimaryKey="false" baseType="STRING" description="" name="servicemax_domain" ordinal="7"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="ServiceMax/Salesforce user ID" name="username" ordinal="1"/></FieldDefinitions></DataShape><Rows><Row><client_id/><client_secret/><grant_type><![CDATA[password]]></grant_type><login_url><![CDATA[https://login.salesforce.com/services/oauth2/token]]></login_url><password/><servicemax_domain><![CDATA[https://svmx-validation.lightning.force.com]]></servicemax_domain><username/></Row></Rows></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for any Things that need to be configured. This allows for OOTB things to be customized, and the new version that should be used can be configured here" isMultiRow="true" name="ThingConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="THINGNAME" description="Name of the Thing entity or Mashup entity that is to be configured" name="thingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable></ConfigurationTables><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/></ThingShape><ImplementedShapes><ImplementedShape name="PTCDTS.SMAXIntegration.Management_TS" type="ThingShape"/></ImplementedShapes><SharedConfigurationTables/><InstanceDesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></InstanceDesignTimePermissions><InstanceRunTimePermissions/><InstanceVisibilityPermissions><Visibility/></InstanceVisibilityPermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.665Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.442Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.445Z" user="Administrator"/></ConfigurationChanges></ThingTemplate></ThingTemplates><ExtensionPackages/><Organizations><Organization aspect.isEditableExtensionObject="true" aspect.isExtension="true" description="" documentationContent="" homeMashup="" lastModifiedDate="2024-01-23T19:48:38.408Z" loginButtonStyle="" loginPrompt="" loginResetPassword="false" loginStyle="" mobileMashup="" name="PTCDTS.SMAXIntegration.Default_OR" projectName="PTCDTS.SMAXIntegration" resetMailContent="&lt;p&gt;[[resetemail.requestmade]]&lt;/p&gt;&lt;p&gt;[[resetemail.instructions]]&lt;/p&gt;&lt;p&gt;[[resetemail.helpneeded]]&lt;/p&gt;" resetMailServer="" resetMailSubject="[[resetemail.subject]]" tags=""><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><loginImage/><Connections><Connection from="" to="Root"/><Connection from="Root" to="PTCDTS.SMAXIntegration.Admin_UG"/><Connection from="Root" to="PTCDTS.SMAXIntegration.Default_UG"/></Connections><OrganizationalUnits><OrganizationalUnit description="" name="PTCDTS.SMAXIntegration.Admin_UG"><Members><Members><Member name="PTCDTS.SMAXIntegration.Admin_UG" type="Group"/></Members></Members></OrganizationalUnit><OrganizationalUnit description="" name="PTCDTS.SMAXIntegration.Default_UG"><Members><Members><Member name="PTCDTS.SMAXIntegration.Default_UG" type="Group"/></Members></Members></OrganizationalUnit><OrganizationalUnit description="" name="Root"><Members><Members/></Members></OrganizationalUnit></OrganizationalUnits><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.657Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.405Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.408Z" user="Administrator"/></ConfigurationChanges></Organization></Organizations><Menus/><ThingGroups/><Resources/><DataTags/><ThingShapes><ThingShape aspect.isEditableExtensionObject="true" aspect.isExtension="true" aspect.isSystemObject="false" className="" description="A Thing Shape that contains methods for authenticating to and interacting with ServiceMax." documentationContent="" homeMashup="" lastModifiedDate="2024-01-23T19:48:38.432Z" name="PTCDTS.SMAXIntegration.Management_TS" projectName="PTCDTS.SMAXIntegration" tags=""><PropertyDefinitions><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="ALWAYS" aspect.isIndexed="false" aspect.isPersistent="true" baseType="STRING" category="Authorization" description="A temporary access token returned to TWX by Salesforce/ServiceMax" isLocalOnly="false" name="access_token" ordinal="2"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isPersistent="true" baseType="LONG" category="Authorization" description="The epoch time the Salesforce/ServiceMax auth token was created. Returned by the authentication call." isLocalOnly="false" name="access_token_issued_time" ordinal="5"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isIndexed="false" aspect.isPersistent="false" baseType="JSON" category="Debugging" description="Temporary property to be used during development." isLocalOnly="false" name="auth_response" ordinal="6"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isPersistent="true" baseType="STRING" category="Authorization" description="The URI to Salesforce/ServiceMax services. Returned by the authentication call." isLocalOnly="false" name="instance_url" ordinal="3"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isIndexed="false" aspect.isPersistent="false" baseType="JSON" category="Debugging" description="DEBUGGING - stores parsed response for debugging purposes." isLocalOnly="false" name="parsed_create_response" ordinal="12"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isIndexed="false" aspect.isPersistent="false" baseType="JSON" category="Debugging" description="DEBUGGING - stores parsed response for debugging purposes." isLocalOnly="false" name="parsed_response" ordinal="10"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" baseType="STRING" category="Debugging" description="DEBUGGING - stores unparsed response for debugging purposes." isLocalOnly="false" name="raw_create_response" ordinal="11"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isIndexed="false" aspect.isPersistent="false" baseType="JSON" category="Debugging" description="A temporary property to hold the response from a call to the SMAX API. We're using it mostly to design an efficient token refresh mechanism." isLocalOnly="false" name="rest_response" ordinal="7"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isIndexed="false" aspect.isPersistent="false" baseType="JSON" category="Debugging" description="A debugging value to hold the JSON we're passing to the PostJSON service of ContentLoader. Will be removed after development is complete." isLocalOnly="false" name="serviceRequestBody" ordinal="8"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.defaultValue="Bearer" aspect.isPersistent="true" baseType="STRING" category="Authorization" description="The type for the Salesforce/ServiceMax auth token. Returned by the authentication call." isLocalOnly="false" name="token_type" ordinal="4"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" baseType="STRING" category="Debugging" description="DEBUGGING - stores unparsed response for debugging purposes." isLocalOnly="false" name="unparsed_response" ordinal="9"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isIndexed="false" aspect.isPersistent="false" baseType="JSON" category="Debugging" description="A debugging value to hold the JSON we're passing to the PostJSON service of ContentLoader. Will be removed after development is complete." isLocalOnly="false" name="workOrderBody" ordinal="13"/></PropertyDefinitions><ServiceDefinitions><ServiceDefinition aspect.isAsync="false" category="Debugging" description="DEBUGGING - clears all the properties on the Thing to help with debugging." isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="ClearProperties"><ResultType baseType="NOTHING" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="Authorization" description="Sends credentials to a Salesforce/ServiceMax login URL and sets properties containing the returned values." isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetAuthToken"><ResultType baseType="STRING" description="Returns SUCCESS if no errors are encountered, otherwise returns an error message." name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="true" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetSMAXDomain"><ResultType baseType="STRING" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="REST API" description="Creates a ServiceMax service request." isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="MakeSMAXRestAPICall"><ResultType baseType="JSON" description="Returns JSON" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="apiEndpoint" ordinal="2"/><FieldDefinition aspect.defaultValue="{&quot;Others&quot;:{&quot;ModelYear&quot;:&quot;2008&quot;,&quot;ThingName&quot;:&quot;MR-1.5T-XDT-7768&quot;,&quot;ProductionCode&quot;:&quot;XDT&quot;},&quot;Asset&quot;:{&quot;ProductName&quot;:&quot;MRI Machine&quot;,&quot;SerialNumber&quot;:&quot;MR-1.5T-XDT-7768&quot;,&quot;InstalledProductName&quot;:&quot;MRI Machine #7768&quot;,&quot;ThingName&quot;:&quot;MR-1.5T-XDT-7768&quot;},&quot;Event&quot;:{&quot;AlertType&quot;:&quot;Above&quot;,&quot;Description&quot;:&quot;5.0 &lt;= 5.5&quot;,&quot;ServiceSessionID&quot;:&quot;DSBBB0056&quot;,&quot;Priority&quot;:&quot;2&quot;,&quot;EventTime&quot;:&quot;2023-04-25 22: 27: 06.006&quot;,&quot;Property&quot;:&quot;Vibration&quot;,&quot;Subject&quot;:&quot;Problem with an MRI machine&quot;}}" aspect.isRequired="true" baseType="JSON" description="{&quot;Asset&quot;: {&quot;ThingName&quot;: &quot;MR-1.5T-XDT-7768&quot;,&quot;ProductName&quot;: &quot;MRI Machine&quot;,&quot;InstalledProductName&quot;: &quot;MRI Machine #7768&quot;,&quot;SerialNumber&quot;: &quot;MR-1.5T-XDT-7768&quot;},&quot;Event&quot;: {&quot;Subject&quot;: &quot;These big magnets, how do they work??&quot;,&quot;Description&quot;: &quot;5.0 &lt;= 5.5&quot;,&quot;Priority&quot;: &quot;2&quot;,&quot;EventTime&quot;: &quot;2023-04-25 22: 27: 06.006&quot;,&quot;AlertType&quot;: &quot;Above&quot;,&quot;Property&quot;: &quot;Vibration&quot;,&quot;ServiceSessionID&quot;: &quot;DSBBB0056&quot;},&quot;Others&quot;: {&quot;ThingName&quot;: &quot;MR-1.5T-XDT-7768&quot;,&quot;ModelYear&quot;: &quot;2008&quot;,&quot;ProductionCode&quot;: &quot;XDT&quot;}}" name="requestJSONBody" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="REST API" description="Parses the response from TWX ContentLoader POST services." isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="parsePostResponse"><ResultType baseType="JSON" description="A parsed response in JSON format." name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition aspect.isRequired="true" baseType="STRING" description="The response returned from a ContentLoader POST service" name="unparsedResponse" ordinal="1"/></ParameterDefinitions></ServiceDefinition></ServiceDefinitions><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="Script" name="ClearProperties"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.access_token = "";
me.access_token_issued_time = 0;
me.auth_response = {};
me.instance_url = {};
me.rest_response = {};
me.serviceRequestBody = {};
me.token_type = "";
me.unparsed_response = "";
me.parsed_response = {};
me.raw_create_response = "";
me.parsed_create_response = {};]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetAuthToken"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// Get configuration items
try {
	let table = me.GetConfigurationTable({tableName: "ServiceMaxConfigTable"});

	// Prepare form data
	let auth_payload = "username=" + table.username;
	auth_payload += "&client_secret=" + table.client_secret;
	auth_payload += "&password=" + table.password;
	auth_payload += "&client_id=" + table.client_id;
    auth_payload += "&grant_type=" + table.grant_type;

	// Prepare headers
	let auth_headers = {
    	"Accept": "application/json",
        "Content-Type": "application/x-www-form-urlencoded"
    };
    
    // Prepare the request
    let auth_params = {
    	"headers": auth_headers,
        "url": table.login_url,
        "content": auth_payload
    };

    // Make request and check output
    let raw_auth_response = Resources["ContentLoaderFunctions"].PostText(auth_params);
    
    // DEBUGGING ONLY
    me.rest_response = raw_auth_response;
    
    let parsed_auth_response = me.parsePostResponse({
		unparsedResponse: raw_auth_response
	});
    
    // DEBUGGING ONLY
    me.auth_response = parsed_auth_response;
    
    if (parsed_auth_response.responseStatus.responseCodes.statusCode == "200"){
        // Set properties
        me.access_token = parsed_auth_response.response.access_token;
		me.token_type = parsed_auth_response.response.token_type;
		me.instance_url = parsed_auth_response.response.instance_url;
        me.access_token_issued_time = parsed_auth_response.response.issued_at;
		result = "SUCCESS";
    } else {
        let errorString = parsed_auth_response.responseStatus.responseCodes.statusCode + ": " + parsed_auth_response.responseStatus.responseCodes.reasonPhrase;
        if(parsed_auth_response.response != null){
        	errorString += ", " + parsed_auth_response.response.error + " - " + parsed_auth_response.response.error_description; 
                
        }
        // Clear properties
        me.access_token = "INVALID";
		me.token_type = "INVALID";
		me.instance_url = "";
        me.access_token_issued_time = 0;
    	logger.error("Problem getting an auth token: " + errorString);
        result = errorString;
    }
} catch(err) {
	logger.error("Error getting auth token: " + err);
    result = err;
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetSMAXDomain"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// table: INFOTABLE dataShape: ""
let table = me.GetConfigurationTable({
	tableName: "ServiceMaxConfigTable" /* STRING */
});

let result = table.servicemax_domain;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="MakeSMAXRestAPICall"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/><FieldDefinition baseType="JSON" description="" name="editorSettings" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
	// If no access token is found, get one
	if (me.access_token === "") {
		let authResult = me.GetAuthToken();
		if (authResult != "SUCCESS") {
			throw new Error("There was an issue authenticating. Please check the script logs.");
		}
	}
	// Prepare body of POST request (this one will use PostJSON)
	let jsonBody = requestJSONBody;
    
    // DEBUGGING
	me.serviceRequestBody = jsonBody;

	// Make the first call to the create service request endpoint
	let createServiceRequest_response = MakeCall(jsonBody);

	// DEBUGGING
	me.raw_create_response = createServiceRequest_response;

	let parsed_response = me.parsePostResponse({
		unparsedResponse: createServiceRequest_response,
	});

	//DEBUGGING
	me.parsed_create_response = parsed_response;

	if (parsed_response.responseStatus.statusCode == "200") {
		result = parsed_response;
	} else if (parsed_response.responseStatus.statusCode == "401") {
		// We may have an expired token. Try getting a new auth token and doing the request again.
		let authResult2 = me.GetAuthToken();
		if (authResult2 != "SUCCESS") {
			throw new Error("There was an issue authenticating. Please check the script logs.");
		}

		let raw_create_response2 = MakeCall(jsonBody);
		//Check return values
		parsed_create_response = me.parsePostResponse({
			unparsedResponse: raw_create_response2,
		});
		if (parsed_create_response.responseStatus.statusCode == "200") {
			result = parsed_response;
		} else {
			// There second attempt, after refreshing the auth token, failed. Give the user information about it.
			let errorString = "Second attempt to create a service request failed: " + parsed_create_response.responseStatus.statusCode + ": " + parsed_create_response.responseStatus.reasonPhrase;
			logger.error(errorString);
			throw new Error(errorString);
		}
	} else {
		// There is a problem other than a bad token. Let the user know.
		let errorString = "Problem creating a service request: " + parsed_response.responseStatus.statusCode + ": " + parsed_response.responseStatus.reasonPhrase;
		logger.error(errorString);
		throw new Error(errorString);
	}
} catch (err) {
	logger.error(err);
	result = parsed_response;
}

function MakeCall(requestBody) {
	try {
		// Prepare headers
		let authString = "Bearer " + me.access_token;

		let headers = {
			Accept: "application/json",
			"Content-Type": "application/json",
			Authorization: authString,
		};

		// Prepare the service endpoint
		let serviceURI = me.instance_url + apiEndpoint;

		// Prepare the request
		let createServiceRequest_params = {
			headers: headers,
			url: serviceURI,
			content: requestBody,
		};
		// DEBUGGING
		logger.debug("Attempting to make a call to " + apiEndpoint + ". REST service params: " + JSON.stringify(createServiceRequest_params));

		let createServiceRequest_response = Resources["ContentLoaderFunctions"].PostJSON(
			createServiceRequest_params
		);
		return createServiceRequest_response;
	} catch (err) {
		logger.error("Problem creating service request: " + err);
	}
}]]></code><editorSettings><json><![CDATA[{"viewState":{"viewState":{"firstPositionDeltaTop":-12,"scrollLeft":0,"firstPosition":{"column":1,"lineNumber":80}},"cursorState":[{"inSelectionMode":false,"selectionStart":{"column":83,"lineNumber":86},"position":{"column":83,"lineNumber":86}}],"contributionsState":{"editor.contrib.wordHighlighter":false,"editor.contrib.folding":{"provider":"indent","lineCount":120,"foldedImports":false}}}}]]></json></editorSettings></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="parsePostResponse"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/><FieldDefinition baseType="JSON" description="" name="editorSettings" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[/* ThingWorx ContentLoader functions return a response that is in a format that needs to be parsed. This service will take 
* a response in that format and return it in usable JSON. The JSON object will have the format:
* parsedResponse = {
*    response: {},
*    requestHeaders: "",
*    responseStatus: {},
*    responseHeaders: ""
* };
*/

/* INTERESTING - It looks like PostText sends back the strangely-formatted response, but PostJSON sends back actual JSON. 
* FURTHER INVESTIGATION IS NEEDED. We need to figure out whether the response is consistent, and perhaps submit a Jira 
* ticket to bring the responses from the two services in line.
*
* ANOTHER TWIST - it seems that PostJSON returns the TWX-specific format for 400 responses, but JSON when the response
* code is 200.
*
* For this PoC, we'll test for unique format vs. JSON by testing for the ^ character. If we find it, we'll parse like
* we started off doing. If we don't find it, we'll just do a simple JSON.parse on the response and send it back.
*/

// DEBUGGING
me.unparsed_response = unparsedResponse;

// Empty object to hold the parsed response
let parsedResponse = {
    response: {},
    requestHeaders: "",
    responseStatus: {},
    responseHeaders: ""
};

// A function to parse the status codes section of the response
let parseResponseCodeString = function (responseCodeString) {
    try {
        let slicedAndTrimmedString = responseCodeString.slice(responseCodeString.indexOf("{") + 1, responseCodeString.lastIndexOf("}")).trim();
        let responseArray = slicedAndTrimmedString.split(":");
        let responseCodesObject = { responseCodes: {} };
        responseArray.forEach(element => {
            let subArray = element.split("=");
            responseCodesObject.responseCodes[subArray[0]] = subArray[1];
        });

        return responseCodesObject;
    } catch (err) {
        logger.error("Problem parsing POST response: " + err);
    }
};

if (unparsedResponse.includes("^")) {
    // DEBUGGING
    // logger.debug("Assumed TWX-specific response format: " + unparsedResponse);

    // Assuming the TWX-specific format that has to be manually parsed.
    let responseArray = unparsedResponse.split("^");
    parsedResponse.response = JSON.parse(responseArray[0]);
    parsedResponse.requestHeaders = responseArray[1];
    if (responseArray.length > 2) {
        parsedResponse.responseStatus = parseResponseCodeString(responseArray[2]);
    }
    if (responseArray.length > 3) {
        parsedResponse.responseHeaders = responseArray[3];
    }
} else {
    // DEBUGGING
    // logger.debug("Assumed well-formed JSON response format: " + unparsedResponse);

    // Assuming a well-formatted JSON response
    parsedResponse = JSON.parse(unparsedResponse);
}

// DEBUGGING
me.parsed_response = parsedResponse;

result = parsedResponse;]]></code><editorSettings><json><![CDATA[{"viewState":{"viewState":{"firstPositionDeltaTop":-8,"scrollLeft":0,"firstPosition":{"column":1,"lineNumber":54}},"cursorState":[{"inSelectionMode":false,"selectionStart":{"column":25,"lineNumber":75},"position":{"column":25,"lineNumber":75}}],"contributionsState":{"editor.contrib.wordHighlighter":false,"editor.contrib.folding":{"provider":"indent","lineCount":75,"foldedImports":false}}}}]]></json></editorSettings></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions/><Owner name="SuperUser" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_OR:PTCDTS.SMAXIntegration.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions><ConfigurationTableDefinition category="" dataShapeName="PTCDTS.SMAXIntegration.AuthenticationConfiguration" description="" isHidden="false" isMultiRow="false" name="ServiceMaxConfigTable" ordinal="0" source="IMPORT"/></ConfigurationTableDefinitions><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="ServiceMaxConfigTable" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="ServiceMax/Salesforce client ID. See SFDC.SMAX docs for more information." name="client_id" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="A secret API key generated within Salesforce/ServiceMax. See ServiceMax docs on how to generate this value." name="client_secret" ordinal="2"/><FieldDefinition aspect.defaultValue="password" aspect.isPrimaryKey="false" baseType="STRING" description="Used by Salesforce/ServiceMax to determine authentication attempt type." name="grant_type" ordinal="4"/><FieldDefinition aspect.defaultValue="https://login.salesforce.com/services/oauth2/token" aspect.isPrimaryKey="false" baseType="STRING" description="The URL provided by Salesforce/ServiceMax" name="login_url" ordinal="6"/><FieldDefinition aspect.isPrimaryKey="false" baseType="PASSWORD" description="Salesforce/ServiceMax password for user defined by username." name="password" ordinal="3"/><FieldDefinition aspect.defaultValue="https://svmx-validation.lightning.force.com" aspect.isPrimaryKey="false" baseType="STRING" description="" name="servicemax_domain" ordinal="7"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="ServiceMax/Salesforce user ID" name="username" ordinal="1"/></FieldDefinitions></DataShape><Rows><Row><client_id/><client_secret/><grant_type><![CDATA[password]]></grant_type><login_url><![CDATA[https://login.salesforce.com/services/oauth2/token]]></login_url><password/><servicemax_domain><![CDATA[https://svmx-validation.lightning.force.com/]]></servicemax_domain><username/></Row></Rows></ConfigurationTable></ConfigurationTables><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations><AlertDefinitions name="access_token"/><AlertDefinitions name="access_token_issued_time"/><AlertDefinitions name="auth_response"/><AlertDefinitions name="instance_url"/><AlertDefinitions name="parsed_create_response"/><AlertDefinitions name="parsed_response"/><AlertDefinitions name="raw_create_response"/><AlertDefinitions name="rest_response"/><AlertDefinitions name="serviceRequestBody"/><AlertDefinitions name="token_type"/><AlertDefinitions name="unparsed_response"/><AlertDefinitions name="workOrderBody"/></AlertConfigurations><InstanceRunTimePermissions><Permissions resourceName="*"><PropertyRead><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_UG" type="Group"/></PropertyRead><PropertyWrite><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_UG" type="Group"/></PropertyWrite><ServiceInvoke><Principal isPermitted="true" name="PTCDTS.SMAXIntegration.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></InstanceRunTimePermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Importing Extension Package Metadata" timestamp="2024-01-23T19:43:00.660Z" user="SuperUser"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.430Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2024-01-23T19:48:38.433Z" user="Administrator"/></ConfigurationChanges></ThingShape></ThingShapes><Subsystems/><NotificationContents/></Entities>